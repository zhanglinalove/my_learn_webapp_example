{"version":3,"sources":["../../src/routes/router.page.js"],"names":["express","require","router","Router","PostModel","marked","config","auth","get","req","res","next","render","title","adminRequired","id","query","findOne","_id","err","post","mkContent","content","session","user","clearCookie","cookieName","path","redirect","module","exports"],"mappings":";;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,SAASF,QAAQG,MAAR,EAAb;AACA,IAAIC,YAAWH,QAAQ,gBAAR,CAAf;AACA,IAAII,SAAQJ,QAAQ,QAAR,CAAZ;AACA,IAAIK,SAASL,QAAQ,WAAR,CAAb;AACA,IAAIM,OAAON,QAAQ,qBAAR,CAAX;;AAGA;AACAC,OAAOM,GAAP,CAAW,GAAX,EAAgB,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AACvCD,MAAIE,MAAJ,CAAa,OAAb;AACD,CAFD;;AAKA;;AAEAV,OAAOM,GAAP,CAAW,QAAX,EAAqB,UAASC,GAAT,EAAeC,GAAf,EAAqBC,IAArB,EAA2B;AAC9CD,MAAIE,MAAJ,CAAY,OAAZ,EAAqB,EAAEC,OAAO,MAAT,EAArB;AAED,CAHD;;AAKA;AACAX,OAAOM,GAAP,CAAW,eAAX,EAA2BD,KAAKO,aAAhC,EAA8C,UAASL,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAwB;AACpED,MAAIE,MAAJ,CAAW,QAAX;AACD,CAFD;;AAKA;;AAEAV,OAAOM,GAAP,CAAW,aAAX,EAA0B,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAAyB;AACjD,MAAII,KAAKN,IAAIO,KAAJ,CAAUD,EAAnB;AACAX,YAAUa,OAAV,CAAkB,EAAEC,KAAKH,EAAP,EAAlB,EAA8B,UAAUI,GAAV,EAAeC,IAAf,EAAoB;AAChDA,SAAKC,SAAL,GAAiBhB,OAAOe,KAAKE,OAAZ,CAAjB;AACAZ,QAAIE,MAAJ,CAAW,MAAX,EAAmB,EAAEQ,UAAF,EAAnB;AACD,GAHD;AAID,CAND;;AASA;AACAlB,OAAOM,GAAP,CAAW,aAAX,EAA0B,UAAUC,GAAV,EAAeC,GAAf,EAAqBC,IAArB,EAA0B;AAClD,MAAII,KAAKN,IAAIO,KAAJ,CAAUD,EAAnB;AACAL,MAAIE,MAAJ,CAAW,MAAX,EAAmB,EAAEG,MAAF,EAAnB;AACD,CAHD;;AAMA;AACAb,OAAOM,GAAP,CAAW,SAAX,EAAsB,UAASC,GAAT,EAAcC,GAAd,EAAoBC,IAApB,EAAyB;AAC7CD,MAAIE,MAAJ,CAAW,QAAX;AAED,CAHD;;AAMA;;AAEAV,OAAOM,GAAP,CAAW,SAAX,EAAsB,UAASC,GAAT,EAAcC,GAAd,EAAoBC,IAApB,EAAyB;AAC7CD,MAAIE,MAAJ,CAAW,QAAX;AAED,CAHD;;AAMA;;AAEAV,OAAOM,GAAP,CAAW,UAAX,EAAuB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC/CF,MAAIc,OAAJ,CAAYC,IAAZ,GAAmB,IAAnB;AACAd,MAAIe,WAAJ,CAAgBnB,OAAOoB,UAAvB,EAAmC,EAAEC,MAAM,GAAR,EAAnC;AACAjB,MAAIkB,QAAJ,CAAa,GAAb;AACD,CAJD;;AAQAC,OAAOC,OAAP,GAAiB5B,MAAjB","file":"router.page.js","sourcesContent":["var express = require('express');\nvar router = express.Router();\nvar PostModel =require('../models/post');\nvar marked =require('marked');\nvar config = require('../config');\nvar auth = require('../middlewares/auth');\n\n\n/* GET Home Page. */\nrouter.get('/', function(req, res, next) {\n  res.render ( 'index');\n});\n\n\n/* GET posts Page. */\n\nrouter.get('/posts', function(req , res , next ){\n  res.render ('posts', { title: '我的文章'});\n\n});\n\n/* GET posts create Page. */\nrouter.get('/posts/create',auth.adminRequired,function(req ,res ,next){\n  res.render('create');\n});\n\n\n/* GET Posts show Page */\n\nrouter.get('/posts/show', function( req, res ,next){\n  var id = req.query.id;\n  PostModel.findOne({ _id: id },function( err, post){\n    post.mkContent = marked(post.content);\n    res.render('show', { post });\n  });\n});\n\n\n/* GET Posts edit Page */\nrouter.get('/posts/edit', function( req ,res , next){\n  var id = req.query.id;\n  res.render('edit', { id });\n});\n\n\n/* GET signup page . */\nrouter.get('/signup', function(req ,res , next){\n  res.render('signup');\n\n});\n\n\n/* GET signin page . */\n\nrouter.get('/signin', function(req ,res , next){\n  res.render('signin');\n\n});\n\n\n/* GET signout */\n\nrouter.get('/signout', function (req, res, next) {\n  req.session.user = null;\n  res.clearCookie(config.cookieName, { path: '/' });\n  res.redirect('/');\n});\n\n\n\nmodule.exports = router;\n"]}